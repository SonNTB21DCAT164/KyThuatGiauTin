def extract_flag_from_mp3(stego_file, flag_length):
    # Đọc file PNG
    with open(stego_file, 'rb') as f:
        stego_data = f.read()

    # Tìm kiếm vị trí bắt đầu của dữ liệu MP3 (kết thúc dữ liệu PNG) 
    png_signature = b'\x89PNG\r\n\x1a\n'
    png_end = stego_data.find(b'IEND') + 8  # 'IEND' chunk + 4 bytes CRC

    # Trích xuất dữ liệu MP3
    mp3_data = stego_data[png_end:]

    # Trích xuất các bit của flag từ LSB của của MP3 data
    flag_bits = ''
    for byte in mp3_data:
        flag_bits += str(byte & 1)

    # Chuyển các bit thành các ký tự ASCII
    flag_chars = [chr(int(flag_bits[i:i+8], 2)) for i in range(0, len(flag_bits), 8)]
    flag = ''.join(flag_chars)

    # Nối các ký tự ASCII để tạo flag
    flag = flag[:flag_length]

    return flag

# Input file
stego_file = 'Can_You_Find_Me.png'
flag_length = 100

# Trích xuất flag từ file PNG
extracted_flag = extract_flag_from_mp3(stego_file, flag_length)
print(f"Extracted Flag: {extracted_flag}")